// defaultTasks 'foo'

// tasks.register("foo") {
//     doLast {
//         println("Hallo Welt")
//     }
// }

import ch.so.agi.gretl.tasks.*

defaultTasks 'run'


// tasks.register('downloadCsv', Download) {
//     src "https://s3.eu-central-1.amazonaws.com/ch.so.data.ingress-demo/$baseName/$csvFileName"
//     dest csvFileObj 
//     overwrite true

//     doLast {
//         println "File downloaded to: " + pathToTempFolder
//     }
// }


// task validate(type: IliValidator) {
//     dataFiles = ["ch.so.afu.abbaustellen.xtf"]
// }

tasks.register('downloadFile', S3Download) {
    accessKey = awsAccessKeyAgi
    secretKey = awsSecretAccessKeyAgi
    downloadDir = file(dataFileKey.substring(dataFileKey.lastIndexOf("/")+1))
    bucketName = "ch.so.agi.gretl.naturgefahren-dev"
    key = dataFileKey
    endPoint = "https://s3.eu-central-1.amazonaws.com" 
    region = "eu-central-1"
}

tasks.register('validate') {
    dependsOn 'downloadFile'
    dataFiles = [dataFileKey.substring(dataFileKey.lastIndexOf("/")+1)]
    doLast {
        println(dataFileKey) 
        println("Hallo Welt.")
    }
}

tasks.register('run') {
    dependsOn 'validate'
}
